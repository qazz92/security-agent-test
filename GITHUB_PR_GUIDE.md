# ğŸš€ GitHub PR ìë™ ìƒì„± ê°€ì´ë“œ

SecurityAgentëŠ” ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•˜ê³  **ì‹¤ì œ GitHub Pull Requestë¥¼ ìë™ìœ¼ë¡œ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

---

## ğŸ“‹ ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### 1. GitHub CLI ì„¤ì¹˜

```bash
# macOS
brew install gh

# Ubuntu/Debian
sudo apt install gh

# Windows
winget install --id GitHub.cli
```

ì„¤ì¹˜ í™•ì¸:
```bash
gh --version
# gh version 2.40.0 (2024-01-01)
```

### 2. GitHub ì¸ì¦

```bash
gh auth login
```

ì¸í„°ë™í‹°ë¸Œ í”„ë¡¬í”„íŠ¸ë¥¼ ë”°ë¼ ì§„í–‰:
1. GitHub.com ì„ íƒ
2. HTTPS ì„ íƒ
3. ë¸Œë¼ìš°ì €ì—ì„œ ì¸ì¦
4. Git credential helper ì‚¬ìš©: Yes

ì¸ì¦ í™•ì¸:
```bash
gh auth status
# âœ“ Logged in to github.com as qazz92
```

### 3. Git Repository ì„¤ì •

í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ê°€ Git repositoryì—¬ì•¼ í•©ë‹ˆë‹¤:

```bash
cd security-agent-portfolio

# ì €ì¥ì†Œ ì´ˆê¸°í™” (ì•„ì§ ì•ˆí–ˆë‹¤ë©´)
git init

# ì›ê²© ì €ì¥ì†Œ ì—°ê²°
git remote add origin https://github.com/qazz92/security-agent-test.git

# ì›ê²© ì €ì¥ì†Œ í™•ì¸
git remote -v
# origin  https://github.com/qazz92/security-agent-test.git (fetch)
# origin  https://github.com/qazz92/security-agent-test.git (push)
```

---

## ğŸ¯ ì‚¬ìš© ë°©ë²•

### ë°©ë²• 1: Agentê°€ ìë™ìœ¼ë¡œ PR ìƒì„± (ê¶Œì¥)

Agentì—ê²Œ GitHub ì €ì¥ì†Œ URLê³¼ í•¨ê»˜ ìš”ì²­í•˜ë©´ ìë™ìœ¼ë¡œ PRì„ ìƒì„±í•©ë‹ˆë‹¤:

```python
import asyncio
from src.agents.orchestrator_agent import SecurityOrchestrator

async def main():
    orchestrator = SecurityOrchestrator(verbose=True)

    # GitHub ì €ì¥ì†Œ URLì„ í¬í•¨í•œ ì¿¼ë¦¬
    query = """
    Comprehensive security analysis for:
    https://github.com/qazz92/security-agent-test

    After analysis, please create a GitHub Pull Request with the fixes.
    """

    result = await orchestrator.analyze_and_remediate(
        'demo/hello-world-vulnerable',
        query
    )

    print("PR URL:", result.get("remediation_plan", {}).get("pr_url"))

asyncio.run(main())
```

### ë°©ë²• 2: CLIì—ì„œ ì§ì ‘ ì‹¤í–‰

```bash
python test_github_pr.py
```

### ë°©ë²• 3: Toolì„ ì§ì ‘ ì‚¬ìš©

```python
from src.tools.github_tools import create_github_pr

result = create_github_pr._run(
    repo_url="https://github.com/qazz92/security-agent-test",
    pr_title="ğŸ”’ Fix Critical Security Vulnerabilities",
    pr_body="""## ğŸ” Security Patch

### Summary
- Fixed 12 security vulnerabilities
- Updated vulnerable dependencies
- Added input validation

### Testing
- [x] All tests pass
- [x] Security scan clean

ğŸ¤– Generated by SecurityAgent
    """,
    branch_name="security-fixes",
    base_branch="main"
)

print("PR Created:", result["pr_url"])
```

---

## ğŸ”„ ìë™ PR ìƒì„± í”„ë¡œì„¸ìŠ¤

SecurityAgentê°€ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ë‹¨ê³„:

```
1. ğŸ“Š ë³´ì•ˆ ì·¨ì•½ì  ë¶„ì„
   â†“
2. ğŸ”§ ìˆ˜ì • ë°©ì•ˆ ìƒì„±
   â†“
3. ğŸ“ PR í…œí”Œë¦¿ ìƒì„±
   â†“
4. ğŸŒ¿ ìƒˆ ë¸Œëœì¹˜ ìƒì„± (security-fixes)
   â†“
5. ğŸ’¾ ë³€ê²½ì‚¬í•­ ì»¤ë°‹
   â†“
6. ğŸš€ ì›ê²© ì €ì¥ì†Œì— í‘¸ì‹œ
   â†“
7. ğŸ”€ GitHub PR ìƒì„±
   â†“
8. âœ… PR URL ë°˜í™˜
```

---

## ğŸ“Š ì˜ˆìƒ ì¶œë ¥

### ì„±ê³µ ì‹œ:

```json
{
  "success": true,
  "pr_url": "https://github.com/qazz92/security-agent-test/pull/1",
  "branch": "security-fixes",
  "base_branch": "main",
  "message": "Pull Request created successfully",
  "commits": 1
}
```

### ì‹¤ì œ ìƒì„±ëœ PR ì˜ˆì‹œ:

**ì œëª©:** `ğŸ”’ Fix 12 Critical Security Vulnerabilities`

**ë³¸ë¬¸:**
```markdown
## ğŸ“Š Summary
- **Total vulnerabilities fixed**: 12
- **Critical**: 4 ğŸš¨
- **High**: 6 âš ï¸
- **Medium**: 2 ğŸ“‹

## ğŸ”§ Changes Made
- Fixed SQL Injection in app.py:57
- Fixed XSS vulnerability in app.py:99
- Removed hardcoded secrets
- Updated Flask to 3.0.0
- Updated requests to 2.31.0

## ğŸ§ª Testing
- [x] All existing tests pass
- [x] New security tests added
- [x] Trivy scan clean

## ğŸ”’ Security Checklist
- [x] No hardcoded secrets
- [x] Input validation added
- [x] Parameterized queries used

ğŸ¤– Generated with SecurityAgent
```

---

## âŒ ë¬¸ì œ í•´ê²°

### ì—ëŸ¬: "GitHub CLI (gh) not installed"

**í•´ê²°:**
```bash
brew install gh  # macOS
```

### ì—ëŸ¬: "GitHub CLI not authenticated"

**í•´ê²°:**
```bash
gh auth login
```

### ì—ëŸ¬: "Failed to push to remote"

**ì›ì¸:** ì›ê²© ì €ì¥ì†Œê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ê¶Œí•œì´ ì—†ìŒ

**í•´ê²°:**
```bash
# ì›ê²© ì €ì¥ì†Œ ì¶”ê°€
git remote add origin https://github.com/qazz92/security-agent-test.git

# ê¶Œí•œ í™•ì¸
gh repo view qazz92/security-agent-test
```

### ì—ëŸ¬: "PR already exists"

**ì›ì¸:** ê°™ì€ ë¸Œëœì¹˜ë¡œ ì´ë¯¸ PRì´ ìƒì„±ë¨

**í•´ê²°:** ë‹¤ë¥¸ ë¸Œëœì¹˜ ì´ë¦„ ì‚¬ìš©
```python
create_github_pr._run(
    ...,
    branch_name="security-fixes-v2"  # ìƒˆ ë¸Œëœì¹˜ ì´ë¦„
)
```

---

## ğŸ¨ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### PR ë¸Œëœì¹˜ ì´ë¦„ ë³€ê²½

```python
result = create_github_pr._run(
    ...,
    branch_name="security-patch-2025-01"  # ì»¤ìŠ¤í…€ ë¸Œëœì¹˜
)
```

### Base ë¸Œëœì¹˜ ë³€ê²½

```python
result = create_github_pr._run(
    ...,
    base_branch="develop"  # main ëŒ€ì‹  develop
)
```

### PR ë³¸ë¬¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•

```python
custom_pr_body = """## ğŸ” Custom Security Patch

### What changed
- Fixed vulnerabilities X, Y, Z

### Why
- To comply with security policies

### Testing
- Manual testing completed
- Automated tests passing

/cc @security-team
"""

result = create_github_pr._run(
    pr_body=custom_pr_body,
    ...
)
```

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **GitHub Token ë³´ì•ˆ**
   - GitHub CLIê°€ ì•ˆì „í•˜ê²Œ í† í° ê´€ë¦¬
   - `.env` íŒŒì¼ì— í† í° ì €ì¥ ë¶ˆí•„ìš”

2. **ìë™ ì»¤ë°‹ ë‚´ìš©**
   - ë¯¼ê°í•œ ì •ë³´ê°€ ì»¤ë°‹ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜
   - `.gitignore` ì„¤ì • í™•ì¸

3. **PR ê¶Œí•œ**
   - Public ì €ì¥ì†Œ: ëˆ„êµ¬ë‚˜ PR ìƒì„± ê°€ëŠ¥
   - Private ì €ì¥ì†Œ: Collaborator ê¶Œí•œ í•„ìš”

---

## ğŸ“š ì¶”ê°€ ê¸°ëŠ¥

### GitHub Issue ìƒì„±

ì·¨ì•½ì ì„ Issueë¡œ íŠ¸ë˜í‚¹:

```python
from src.tools.github_tools import create_github_issue

result = create_github_issue._run(
    repo_url="https://github.com/qazz92/security-agent-test",
    issue_title="ğŸ› SQL Injection Vulnerability in app.py",
    issue_body="""## Description
SQL Injection vulnerability found in line 57.

## Impact
CRITICAL - Database compromise possible

## Recommendation
Use parameterized queries
    """,
    labels=["security", "critical", "bug"]
)
```

---

## ğŸ¯ Best Practices

1. **PR ìƒì„± ì „ ë¡œì»¬ í…ŒìŠ¤íŠ¸**
   ```bash
   pytest tests/
   trivy fs .
   ```

2. **ì˜ë¯¸ìˆëŠ” ë¸Œëœì¹˜ ì´ë¦„**
   ```python
   branch_name="security-fix-sql-injection-2025-01"
   ```

3. **ìƒì„¸í•œ PR ì„¤ëª…**
   - ë¬´ì—‡ì„ ê³ ì³¤ëŠ”ì§€
   - ì™œ ê³ ì³¤ëŠ”ì§€
   - ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸í–ˆëŠ”ì§€

4. **íŒ€ íƒœê·¸**
   ```markdown
   /cc @security-team @backend-team
   ```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

PRì´ ìƒì„±ë˜ë©´:

1. âœ… **Code Review**: íŒ€ì›ì—ê²Œ ë¦¬ë·° ìš”ì²­
2. âœ… **CI/CD í™•ì¸**: GitHub Actions ìë™ ì‹¤í–‰ í™•ì¸
3. âœ… **í…ŒìŠ¤íŠ¸ í†µê³¼**: ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ”ì§€ í™•ì¸
4. âœ… **Merge**: ë¦¬ë·° ìŠ¹ì¸ í›„ ë³‘í•©
5. âœ… **ë°°í¬**: Production í™˜ê²½ì— ë°°í¬

---

## ğŸ’¡ íŒ

- **ìë™í™” ìŠ¤í¬ë¦½íŠ¸**: Cron jobìœ¼ë¡œ ì •ê¸° ìŠ¤ìº” ë° PR ìƒì„±
- **Slack ì•Œë¦¼**: PR ìƒì„± ì‹œ Slackì— ìë™ ì•Œë¦¼
- **Jira ì—°ë™**: ì·¨ì•½ì ì„ Jira í‹°ì¼“ìœ¼ë¡œ ìë™ ìƒì„±

---

**ì´ì œ ë³´ì•ˆ ì·¨ì•½ì  ìˆ˜ì •ì´ ì™„ì „íˆ ìë™í™”ë©ë‹ˆë‹¤!** ğŸ‰